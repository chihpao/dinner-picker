<template>
  <div>
    <AppHeader title="ä»Šæ™šåƒå“ªå®¶ï¼Ÿ">
      <template #actions>
        <NuxtLink to="/expense-entry?from=/" class="btn" aria-label="é–‹å•Ÿé£Ÿç‰©è¨˜å¸³">ğŸ± é£Ÿç‰©è¨˜å¸³</NuxtLink>
        <NuxtLink to="/expenses" class="btn" aria-label="æŸ¥çœ‹é£Ÿç‰©ç¸½è¦½">ğŸ“Š é£Ÿç‰©ç¸½è¦½</NuxtLink>
        <NuxtLink to="/total" class="btn" aria-label="é–‹å•Ÿå…¨æ¶ˆè²»ç¸½è¦½">ğŸ“š å…¨æ¶ˆè²»ç¸½è¦½</NuxtLink>
      </template>
      <template #bottom>
        <div id="toolbar" class="toolbar">
          <button v-if="!userLocation && !hasAllowedLocation" @click="requestLocation" class="btn danger">ğŸ“ å…è¨±ç›®å‰ä½ç½®</button>
        </div>
      </template>
    </AppHeader>

    <main id="app-main">
      <div v-if="isLoading" class="loader">
        <div class="loader-lines"></div>
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
      <div v-else class="grid">
        <RestaurantCard 
          v-for="restaurant in processedRestaurants" 
          :key="restaurant.id" 
          :restaurant="restaurant" 
        />
      </div>
    </main>

    <div class="tooltip" role="tooltip" aria-hidden="true"></div>
  </div>
</template>

<script setup lang="ts">
useHead({
  title: 'ä»Šæ™šåƒå“ªå®¶ï¼Ÿ',
  meta: [
    { name: 'theme-color', content: '#e3f2fd' }
  ]
})

const { processedRestaurants, isLoading, userLocation, requestLocation, hasAllowedLocation } = useRestaurants()
</script>
