import{_ as C}from"./jBfyXZ3o.js";import{_ as u}from"./DlAUqK2U.js";import{c as l,o as r,a as s,p as O,e as b,r as y,n as x,f as d,q as m,b as e,w as p,y as S,D as $,E as j,G as B,C as R,m as T,z}from"./B6HfJZvd.js";import{I as L}from"./DYEn4bPy.js";import{u as D}from"./BjSyBa9A.js";import{u as q}from"./jYp98l9n.js";import{u as V}from"./2ykuDYuY.js";const X={},H={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"square","stroke-linejoin":"miter"};function U(i,t){return r(),l("svg",H,[...t[0]||(t[0]=[s("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},null,-1),s("polyline",{points:"9 22 9 12 15 12 15 22"},null,-1)])])}const M=Object.assign(u(X,[["render",U]]),{__name:"IconsIconHome"}),W={},G={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"square","stroke-linejoin":"miter"};function F(i,t){return r(),l("svg",G,[...t[0]||(t[0]=[s("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},null,-1),s("path",{d:"M22 12A10 10 0 0 0 12 2v10z"},null,-1)])])}const A=Object.assign(u(W,[["render",F]]),{__name:"IconsIconOverview"}),J={},K={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"square","stroke-linejoin":"miter"};function Q(i,t){return r(),l("svg",K,[...t[0]||(t[0]=[O('<line x1="1" y1="11" x2="23" y2="11"></line><line x1="1" y1="20" x2="23" y2="20"></line><line x1="4" y1="20" x2="4" y2="11"></line><line x1="20" y1="20" x2="20" y2="11"></line><line x1="12" y1="20" x2="12" y2="11"></line><path d="M1 11h22L12 2 1 11z"></path>',6)])])}const N=Object.assign(u(J,[["render",Q]]),{__name:"IconsIconBank"}),Y={class:"sidebar-brand"},Z={key:0,class:"brand-content"},tt={class:"sidebar-nav"},st={class:"nav-group"},et={class:"icon"},nt={key:0,class:"text"},ot={class:"nav-group"},at={class:"icon"},ct={key:0,class:"text"},it={class:"icon"},lt={key:0,class:"text"},rt={class:"icon"},dt={key:0,class:"text"},_t=b({__name:"AppSidebar",setup(i){const t=y(!1),a=()=>t.value=!t.value;return(o,c)=>{const _=C;return r(),l("aside",{class:x(["sidebar",{collapsed:d(t)}])},[s("div",Y,[d(t)?m("",!0):(r(),l("div",Z,[...c[0]||(c[0]=[s("div",{class:"brand-text"},"Dinner Picker",-1)])])),s("button",{class:"toggle-btn",onClick:a},[s("span",{class:x(["arrow",{flipped:d(t)}])},"◀",2)])]),s("nav",tt,[s("div",st,[e(_,{to:"/",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",et,[e(M)]),d(t)?m("",!0):(r(),l("span",nt,"首頁"))]),_:1})]),s("div",ot,[e(_,{to:"/total/entry",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",at,[e(L)]),d(t)?m("",!0):(r(),l("span",ct,"一般記帳"))]),_:1}),e(_,{to:"/total",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",it,[e(A)]),d(t)?m("",!0):(r(),l("span",lt,"全消費總覽"))]),_:1}),e(_,{to:"/total/accounts",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",rt,[e(N)]),d(t)?m("",!0):(r(),l("span",dt,"帳戶管理"))]),_:1})])])],2)}}}),pt=Object.assign(u(_t,[["__scopeId","data-v-2df46617"]]),{__name:"AppSidebar"});function I(){const i=y(!1),t=()=>{i.value=window.matchMedia("(display-mode: standalone)").matches};return S(()=>{t(),window.addEventListener("appinstalled",t),window.addEventListener("beforeinstallprompt",t)}),$(()=>{window.removeEventListener("appinstalled",t),window.removeEventListener("beforeinstallprompt",t)}),{isPwa:i}}const ut={class:"icon-box"},vt={class:"icon-box"},mt={class:"icon-box"},ft={class:"icon-box"},ht=b({__name:"MobileNav",setup(i){const{isPwa:t}=I();return(a,o)=>{const c=C;return r(),l("nav",{class:x(["mobile-nav",{"pwa-bottom":d(t)}])},[e(c,{to:"/",exact:"",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",ut,[e(M)]),o[0]||(o[0]=s("span",{class:"label"},"首頁",-1))]),_:1}),e(c,{to:"/total/entry",exact:"",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",vt,[e(L)]),o[1]||(o[1]=s("span",{class:"label"},"記帳",-1))]),_:1}),e(c,{to:"/total",exact:"",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",mt,[e(A)]),o[2]||(o[2]=s("span",{class:"label"},"總覽",-1))]),_:1}),e(c,{to:"/total/accounts",exact:"",class:"nav-item","active-class":"active"},{default:p(()=>[s("span",ft,[e(N)]),o[3]||(o[3]=s("span",{class:"label"},"帳戶",-1))]),_:1})],2)}}}),wt=Object.assign(u(ht,[["__scopeId","data-v-c5d650bc"]]),{__name:"MobileNav"});function xt(){const i=j(),t=B(),a=["/","/total/entry","/total","/total/accounts"];let o=0,c=0;const _=50,h=n=>{o=n.changedTouches[0].screenX},w=n=>{},v=n=>{c=n.changedTouches[0].screenX,k()},k=()=>{const n=t.path,f=a.indexOf(n);if(f===-1)return;const P=c-o;P>_?f>0&&i.push(a[f-1]):P<-_&&f<a.length-1&&i.push(a[f+1])},E=n=>{n&&(n.addEventListener("touchstart",h),n.addEventListener("touchmove",w),n.addEventListener("touchend",v))},g=n=>{n&&(n.removeEventListener("touchstart",h),n.removeEventListener("touchmove",w),n.removeEventListener("touchend",v))};return $(()=>{}),{initSwipe:E,destroySwipe:g}}const bt={key:0,class:"pwa-install-prompt"},kt=b({__name:"PwaInstallPrompt",setup(i){const{isPwa:t}=I(),a=R("pwa-install-event"),o=async()=>{if(!a.value)return;a.value.prompt();const{outcome:c}=await a.value.userChoice;console.log(c==="accepted"?"User accepted the PWA installation prompt":"User dismissed the PWA installation prompt"),a.value=null};return(c,_)=>d(a)&&!d(t)?(r(),l("div",bt,[s("button",{onClick:o}," 下載應用程式 ")])):m("",!0)}}),gt=Object.assign(u(kt,[["__scopeId","data-v-4bc97209"]]),{__name:"PwaInstallPrompt"}),yt={class:"app-layout"},$t={class:"sidebar-wrapper"},It={class:"wrap"},Et=b({__name:"default",setup(i){const{initAuth:t,user:a}=D(),{fetchRestaurants:o}=q(),{loadEntries:c}=V(),{initSwipe:_,destroySwipe:h}=xt(),{isPwa:w}=I(),v=y(null);return S(()=>{t(),o(),_(v.value)}),$(()=>{h(v.value)}),T(a,()=>{c()},{immediate:!0}),(k,E)=>{const g=pt,n=wt;return r(),l("div",yt,[s("div",$t,[e(g)]),s("div",{ref_key:"mainContentRef",ref:v,class:x(["main-content",{"pwa-content-bottom-nav":d(w)}])},[s("div",It,[z(k.$slots,"default",{},void 0)]),e(n)],2),e(gt)])}}}),Ot=u(Et,[["__scopeId","data-v-7bcf091d"]]);export{Ot as default};
