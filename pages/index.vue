<template>
  <div>
    <AppHeader title="ä»Šæ™šåƒå“ªå®¶ï¼Ÿ">
      <template #actions>
        <button 
          v-if="!userLocation && !hasAllowedLocation" 
          @click="requestLocation" 
          class="btn danger whitespace-nowrap"
          aria-label="å…è¨±ç›®å‰ä½ç½®"
        >
          ğŸ“ <span class="mobile-hidden-text">å…è¨±ç›®å‰ä½ç½®</span>
        </button>
      </template>
    </AppHeader>

    <main id="app-main">
      <div v-if="isLoading" class="loader">
        <div class="loader-lines"></div>
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
      <div v-else class="grid">
        <RestaurantCard 
          v-for="restaurant in processedRestaurants" 
          :key="restaurant.id" 
          :restaurant="restaurant" 
        />
      </div>
    </main>

    <div class="tooltip" role="tooltip" aria-hidden="true"></div>
  </div>
</template>

<script setup lang="ts">
useHead({
  title: 'ä»Šæ™šåƒå“ªå®¶ï¼Ÿ',
  meta: [
    { name: 'theme-color', content: '#e3f2fd' }
  ]
})

const { processedRestaurants, isLoading, userLocation, requestLocation, hasAllowedLocation } = useRestaurants()
</script>
